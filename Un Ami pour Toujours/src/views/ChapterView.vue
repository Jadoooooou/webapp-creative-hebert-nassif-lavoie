<template> <!-- Stucture de la page -->
  <div class="pageChapter">
    <div>
      <div class="icone poubelle">
        <IconePoubelle/>
      </div>
      <div class="icone ordi">
        <IconeOrdi/>
      </div>
      <div class="icone doc">
        <IconeDoc/>
      </div>
    </div>
    <div>
      <NarrativeText :chapter="storyData[0].chapters[currentChapter]"/>
      <ChoicePanel :chapter="storyData[0].chapters[currentChapter]" @choose="changeChapter"/>
    </div>
  </div>
  <AppFooter />
</template>

<!-- Importer notre footer, pinia et story import√© de la store pinia -->
<script>
import { mapStores } from "pinia";
import { useStoryStore } from "../stores/story";
import AppFooter from "../components/layout/AppFooter.vue";
import IconePoubelle from '../components/specific/IconePoubelle.vue';
import IconeOrdi from '../components/specific/IconeOrdi.vue';
import IconeDoc from '../components/specific/IconeDoc.vue';
import ChoicePanel from "../components/common/ChoicePanel.vue";
import NarrativeText from "../components/common/NarrativeText.vue";

export default {
  props: {},
  emits: [],
  components: {
    AppFooter,
    IconePoubelle,
    IconeOrdi,
    IconeDoc,
    ChoicePanel,
    NarrativeText,
  },
  computed: {
    // Store accessible via l'objet 
    ...mapStores(useStoryStore),
  },
  data() { // Temporaire avant de faire le lien avec pinia
    return {
      currentChapter: "1",
      storyData: [{
        "chapters": {
          "1": {
            "title": "La for√™t myst√©rieuse",
            "text": "Bonjour‚ÄØ! Tu me vois bien ? Je suis Germaine la Grenouille. Il fait froid ici, tu sais‚Ä¶ fait un petit bout que personne n‚Äô est venu jouer avec moi.Alors,je t‚Äô ai trouv√©. √Ä travers les vagues, les ondes, les pixels.Tu es venu. Je veux te montrer mon monde.Bon il n‚Äô y a pas grand - chose mais si tu es venu jusqu‚Äô √† moi, c‚Äô est pour √™tre amis, non ? Tu va voir, mon programme est peut - √™tre vieux, mais je suis s√ªre que tu voudras y rester avec moi!Mais avant, dis - moi qui tu es‚Ä¶ ",
            "choices": [{
              "id": 1,
              "text": "Prendre le chemin de gauche üå≤",
              "nextChapter": "2",
              "type": "path"
            },
            {
              "id": 2,
              "text": "Prendre le chemin de droite üèîÔ∏è",
              "nextChapter": "3",
              "type": "path"
            }
            ]
          },
          "2": {
            "title": "Le pont suspendu",
            "text": "Voici un petit formulaire qui m‚Äôaideras √† plus en savoir sur toi‚ÄØ! Tu n‚Äôas qu‚Äô√† r√©pondre aux questions dans les rectangles blancs.",
            "choices": [{
              "id": 1,
              "text": "Traverser le pont üåâ",
              "nextChapter": "4",
              "type": "path"
            },
            {
              "id": 2,
              "text": "Longer la rivi√®re üèûÔ∏è",
              "nextChapter": "5",
              "type": "path"
            }
            ]
          },
          "4": {
            "title": "La montagne",
            "text": "Elle parle d‚Äôune grenouille. Mais aussi‚Ä¶ un peu de toi. Il √©tait une fois‚Ä¶ une grenouille qui voulait √™tre aim√©e. Mais personne ne venait plus la voir. Son programme √©tait devenu trop vieux. Alors, elle a trouv√© une faille, un petit trou entre les mondes. Un miroir d‚Äôeau qui s‚Äôappelait √©cran. Et de l‚Äôautre c√¥t√©‚Ä¶ il y avait toi, [NOM]. Tu n‚Äôes pas le premier utilisateur qui est venu me voir. Ils voulaient eux aussi jouer avec moi et devenir les meilleurs amis‚ÄØ! Mais ils ont vite trouv√© mon jeu trop lent √† comparer des autres, et ils ont tous quitter mon programme.Mais toi, c‚Äôest pour la vie, en‚ÄØ? De toutes fa√ßons, apr√®s tout ce temps √† t‚Äôattendre, j‚Äôai trouv√© la solution pour que l‚Äôon reste amis, c‚Äô√©tait quoi d√©j√†‚Ä¶ Ah oui‚ÄØ!",

            "choices": [{
              "id": 1,
              "text": "Grimper au sommet ‚õ∞Ô∏è",
              "nextChapter": "6",
              "type": "path"
            },
            {
              "id": 2,
              "text": "Chercher une grotte üï≥Ô∏è",
              "nextChapter": "7",
              "type": "path"
            }
            ]
          },
          "7": {
            "title": "Village abandonn√©",
            "text": "Tu es Tomb√© dans le pi√®ge‚Ä¶",
            "choices": [{
              "id": 1,
              "text": "Recommencer",
              "nextChapter": "1",
              "type": "restart"
            },
            {
              "id": 2
            }]
          },
          "8": {
            "title": "Cascade cach√©e",
            "text": "Je saurai te retrouver.",
            "choices": [{
              "id": 1,
              "text": "Recommencer",
              "nextChapter": "1",
              "type": "restart"
            }]
          }
        }
      }]

    }
  },
  methods: {
    changeChapter(next) {
      this.currentChapter = next;
    }
  }
};
</script>

<!-- Style css de la page -->
<style scoped>
.pageChapter {
  background-color: #92a48d;
  height: 100vh;
}

.img {
  width: 100px;
}

.icone {
  padding: 10px;
  width: 100px;
  text-align: center;
  display: flex;
  position: absolute;
  z-index: 20;
}

.poubelle {
  top: 20px;
}

.ordi {
  top: 160px;
}

.doc {
  top: 300px;
}

p {
  color: white;
  margin: 0;
}
</style>
